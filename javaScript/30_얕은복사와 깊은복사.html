<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js">
  </script>
  <script>
    //얕은 복사(Shallow copy), 깊은 복사(Deep copy)
    const user = {
      name: "kim",
      age: 40,
      emails: ['thekim@gmail.com']
    }
    //const copyUser =user  //얕은복사
    //const copyUser =Object.assign({}, user)  //깊은복사
    // let copyUser = {
      // ...user
    //} 전개연산자 활용 깊은복사같지만 emails는 얕은복사가 된다.
    // let copyUser = {
    //   name: user.name,
    //   age: user.age,
    //   email: user.emails
    // }
    console.log(copyUser)
    console.log(copyUser === user) //false 깊은 복사
    console.log(copyUser.emails === user.emails) //true 그러나 emails는 얕은복사

    user.age = 22
    console.log('user', user)
    console.log('copyUser', copyUser)
    console.log('-------------');
    console.log('-------------');
    user.emails.push('neo@naver.com')
    console.log(user.emails, copyUser.emails); //얕은복사이므로 같은요소값이 출력됨
    console.log('user', user);
    console.log('copyUser', copyUser);
    //deep copy는 lodash 라이브러리의 cloneDeep()를 이용해서 쉽게 할수 있지만
    //실력을 위해 직접구현해 보자 
    //copyUser=_.cloneDeep(user) // lodash 라이브러리 사용 
    copyUser = {}
    deepCopy(user, copyUser)
    console.log('deepCopy call after')
    console.log(user.emails === copyUser.emails); //깊은복사가 되어 false
    user.emails.push('xxx@naver.com', 'yyy@nuri.net')
    console.log('user', user); //['thekim@gmail.com','neo@naver.com','xxx@naver.com','yyy@nuri.net']
    console.log('copyUser', copyUser); //['thekim@gmail.com','neo@naver.com']

    function deepCopy(source, target) {
      target.name = source.name
      target.age = source.age
      target.emails = []
      //문제> source.emails 배열의 값을 순차적으로 target.emails배열로 복사하시오
      for (let email of source.emails) {
        target.emails.push(email)
      }
      //source.emails.forEach(email => target.emails.push(email));
      //target.emails.push(...source.emails)
    }
  </script>
</body>

</html>